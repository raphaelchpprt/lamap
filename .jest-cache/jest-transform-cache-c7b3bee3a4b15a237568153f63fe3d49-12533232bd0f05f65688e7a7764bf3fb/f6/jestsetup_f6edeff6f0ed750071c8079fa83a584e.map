{"version":3,"sources":["/Users/Raphael/Documents/DEV.nosync/lamap/jest.setup.js"],"sourcesContent":["// Setup pour Jest - Configuration globale des tests\n\n// Import des utilitaires de test\nimport '@testing-library/jest-dom';\n\n// Mock global pour window.matchMedia (nécessaire pour certains composants)\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation((query) => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(), // deprecated\n    removeListener: jest.fn(), // deprecated\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// Mock pour IntersectionObserver\nglobal.IntersectionObserver = class IntersectionObserver {\n  constructor() {}\n  observe() {\n    return null;\n  }\n  disconnect() {\n    return null;\n  }\n  unobserve() {\n    return null;\n  }\n};\n\n// Mock pour ResizeObserver\nglobal.ResizeObserver = class ResizeObserver {\n  constructor(callback) {\n    this.callback = callback;\n  }\n  observe() {\n    return null;\n  }\n  unobserve() {\n    return null;\n  }\n  disconnect() {\n    return null;\n  }\n};\n\n// Mock pour l'API Geolocation\nconst mockGeolocation = {\n  getCurrentPosition: jest.fn().mockImplementation((success) =>\n    Promise.resolve(\n      success({\n        coords: {\n          latitude: 46.603354, // Coordonnées de la France (centre approximatif)\n          longitude: 1.888334,\n          accuracy: 1000,\n        },\n      })\n    )\n  ),\n  watchPosition: jest.fn(),\n  clearWatch: jest.fn(),\n};\n\nObject.defineProperty(global.navigator, 'geolocation', {\n  value: mockGeolocation,\n});\n\n// Mock pour fetch (pour les appels API)\nglobal.fetch = jest.fn();\n\n// Variables d'environnement pour les tests\nprocess.env.NEXT_PUBLIC_MAPBOX_TOKEN = 'pk.test_token_for_jest';\nprocess.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co';\nprocess.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test_anon_key';\n\n// Nettoyage après chaque test\nafterEach(() => {\n  jest.clearAllMocks();\n\n  // Reset fetch mock\n  if (global.fetch && global.fetch.mockClear) {\n    global.fetch.mockClear();\n  }\n});\n\n// Configuration des timeouts pour les tests async\njest.setTimeout(10000);\n\n// Mock console.error pour capturer les erreurs React\nconst originalError = console.error;\nbeforeAll(() => {\n  console.error = (...args) => {\n    if (\n      typeof args[0] === 'string' &&\n      args[0].includes('Warning: ReactDOM.render is no longer supported')\n    ) {\n      return;\n    }\n    originalError.call(console, ...args);\n  };\n});\n\nafterAll(() => {\n  console.error = originalError;\n});\n"],"names":["Object","defineProperty","window","writable","value","jest","fn","mockImplementation","query","matches","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","global","IntersectionObserver","observe","disconnect","unobserve","ResizeObserver","callback","mockGeolocation","getCurrentPosition","success","Promise","resolve","coords","latitude","longitude","accuracy","watchPosition","clearWatch","navigator","fetch","process","env","NEXT_PUBLIC_MAPBOX_TOKEN","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","afterEach","clearAllMocks","mockClear","setTimeout","originalError","console","error","beforeAll","args","includes","call","afterAll"],"mappings":"AAAA,oDAAoD;AAEpD,iCAAiC;;;;;QAC1B;AAEP,2EAA2E;AAC3EA,OAAOC,cAAc,CAACC,QAAQ,cAAc;IAC1CC,UAAU;IACVC,OAAOC,KAAKC,EAAE,GAAGC,kBAAkB,CAAC,CAACC,QAAW,CAAA;YAC9CC,SAAS;YACTC,OAAOF;YACPG,UAAU;YACVC,aAAaP,KAAKC,EAAE;YACpBO,gBAAgBR,KAAKC,EAAE;YACvBQ,kBAAkBT,KAAKC,EAAE;YACzBS,qBAAqBV,KAAKC,EAAE;YAC5BU,eAAeX,KAAKC,EAAE;QACxB,CAAA;AACF;AAEA,iCAAiC;AACjCW,OAAOC,oBAAoB,GAAG,MAAMA;IAClC,aAAc,CAAC;IACfC,UAAU;QACR,OAAO;IACT;IACAC,aAAa;QACX,OAAO;IACT;IACAC,YAAY;QACV,OAAO;IACT;AACF;AAEA,2BAA2B;AAC3BJ,OAAOK,cAAc,GAAG,MAAMA;IAC5B,YAAYC,QAAQ,CAAE;QACpB,IAAI,CAACA,QAAQ,GAAGA;IAClB;IACAJ,UAAU;QACR,OAAO;IACT;IACAE,YAAY;QACV,OAAO;IACT;IACAD,aAAa;QACX,OAAO;IACT;AACF;AAEA,8BAA8B;AAC9B,MAAMI,kBAAkB;IACtBC,oBAAoBpB,KAAKC,EAAE,GAAGC,kBAAkB,CAAC,CAACmB,UAChDC,QAAQC,OAAO,CACbF,QAAQ;YACNG,QAAQ;gBACNC,UAAU;gBACVC,WAAW;gBACXC,UAAU;YACZ;QACF;IAGJC,eAAe5B,KAAKC,EAAE;IACtB4B,YAAY7B,KAAKC,EAAE;AACrB;AAEAN,OAAOC,cAAc,CAACgB,OAAOkB,SAAS,EAAE,eAAe;IACrD/B,OAAOoB;AACT;AAEA,wCAAwC;AACxCP,OAAOmB,KAAK,GAAG/B,KAAKC,EAAE;AAEtB,2CAA2C;AAC3C+B,QAAQC,GAAG,CAACC,wBAAwB,GAAG;AACvCF,QAAQC,GAAG,CAACE,wBAAwB,GAAG;AACvCH,QAAQC,GAAG,CAACG,6BAA6B,GAAG;AAE5C,8BAA8B;AAC9BC,UAAU;IACRrC,KAAKsC,aAAa;IAElB,mBAAmB;IACnB,IAAI1B,OAAOmB,KAAK,IAAInB,OAAOmB,KAAK,CAACQ,SAAS,EAAE;QAC1C3B,OAAOmB,KAAK,CAACQ,SAAS;IACxB;AACF;AAEA,kDAAkD;AAClDvC,KAAKwC,UAAU,CAAC;AAEhB,qDAAqD;AACrD,MAAMC,gBAAgBC,QAAQC,KAAK;AACnCC,UAAU;IACRF,QAAQC,KAAK,GAAG,CAAC,GAAGE;QAClB,IACE,OAAOA,IAAI,CAAC,EAAE,KAAK,YACnBA,IAAI,CAAC,EAAE,CAACC,QAAQ,CAAC,oDACjB;YACA;QACF;QACAL,cAAcM,IAAI,CAACL,YAAYG;IACjC;AACF;AAEAG,SAAS;IACPN,QAAQC,KAAK,GAAGF;AAClB"}