78abba10b0c7da2abab41b8f345dbaf7
// @ts-nocheck - Supabase types need to be generated. Run: npx supabase gen types typescript
'use server';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get createInitiative () {
        return createInitiative;
    },
    get deleteInitiative () {
        return deleteInitiative;
    },
    get getInitiativeById () {
        return getInitiativeById;
    },
    get updateInitiative () {
        return updateInitiative;
    },
    get verifyInitiative () {
        return verifyInitiative;
    }
});
const _cache = require("next/cache");
const _server = require("../lib/supabase/server");
async function createInitiative(data) {
    try {
        // Validation
        if (!data.name || data.name.trim().length < 3) {
            return {
                success: false,
                error: 'Le nom doit contenir au moins 3 caractères'
            };
        }
        if (!data.type) {
            return {
                success: false,
                error: 'Le type est obligatoire'
            };
        }
        if (isNaN(data.latitude) || isNaN(data.longitude)) {
            return {
                success: false,
                error: 'Les coordonnées GPS sont invalides'
            };
        }
        if (data.latitude < -90 || data.latitude > 90 || data.longitude < -180 || data.longitude > 180) {
            return {
                success: false,
                error: 'Les coordonnées GPS sont hors limites'
            };
        }
        // Get authenticated user
        const supabase = await (0, _server.createClient)();
        const { data: { user }, error: authError } = await supabase.auth.getUser();
        if (authError || !user) {
            return {
                success: false,
                error: 'Vous devez être connecté pour ajouter une initiative'
            };
        }
        // Create initiative with PostGIS POINT
        const { data: initiative, error: insertError } = await supabase.from('initiatives').insert({
            name: data.name.trim(),
            type: data.type,
            description: data.description?.trim() || null,
            address: data.address?.trim() || null,
            location: `POINT(${data.longitude} ${data.latitude})`,
            website: data.website?.trim() || null,
            phone: data.phone?.trim() || null,
            email: data.email?.trim() || null,
            user_id: user.id,
            verified: false
        }).select('id').single();
        if (insertError) {
            console.error('Supabase insert error:', insertError);
            return {
                success: false,
                error: `Erreur lors de l'ajout: ${insertError.message}`
            };
        }
        // Revalidate the homepage to show the new initiative
        (0, _cache.revalidatePath)('/');
        return {
            success: true,
            data: {
                id: initiative.id
            }
        };
    } catch (error) {
        console.error('Error creating initiative:', error);
        return {
            success: false,
            error: error instanceof Error ? error.message : 'Une erreur est survenue'
        };
    }
}
async function updateInitiative(id, data) {
    try {
        if (!id) {
            return {
                success: false,
                error: "L'ID de l'initiative est requis"
            };
        }
        // Get authenticated user
        const supabase = await (0, _server.createClient)();
        const { data: { user }, error: authError } = await supabase.auth.getUser();
        if (authError || !user) {
            return {
                success: false,
                error: 'Vous devez être connecté pour modifier une initiative'
            };
        }
        // Check if initiative exists and user owns it
        const { data: existing, error: fetchError } = await supabase.from('initiatives').select('user_id').eq('id', id).single();
        if (fetchError || !existing) {
            return {
                success: false,
                error: 'Initiative non trouvée'
            };
        }
        if (existing.user_id !== user.id) {
            return {
                success: false,
                error: "Vous n'êtes pas autorisé à modifier cette initiative"
            };
        }
        // Prepare update data
        const updateData = {};
        if (data.name !== undefined) {
            if (data.name.trim().length < 3) {
                return {
                    success: false,
                    error: 'Le nom doit contenir au moins 3 caractères'
                };
            }
            updateData.name = data.name.trim();
        }
        if (data.type !== undefined) {
            updateData.type = data.type;
        }
        if (data.description !== undefined) {
            updateData.description = data.description?.trim() || null;
        }
        if (data.address !== undefined) {
            updateData.address = data.address?.trim() || null;
        }
        if (data.website !== undefined) {
            updateData.website = data.website?.trim() || null;
        }
        if (data.phone !== undefined) {
            updateData.phone = data.phone?.trim() || null;
        }
        if (data.email !== undefined) {
            updateData.email = data.email?.trim() || null;
        }
        // Update location if both coordinates are provided
        if (data.latitude !== undefined && data.longitude !== undefined) {
            if (isNaN(data.latitude) || isNaN(data.longitude)) {
                return {
                    success: false,
                    error: 'Les coordonnées GPS sont invalides'
                };
            }
            if (data.latitude < -90 || data.latitude > 90 || data.longitude < -180 || data.longitude > 180) {
                return {
                    success: false,
                    error: 'Les coordonnées GPS sont hors limites'
                };
            }
            updateData.location = `POINT(${data.longitude} ${data.latitude})`;
        }
        // Update initiative
        const { error: updateError } = await supabase.from('initiatives').update(updateData).eq('id', id);
        if (updateError) {
            console.error('Supabase update error:', updateError);
            return {
                success: false,
                error: `Erreur lors de la modification: ${updateError.message}`
            };
        }
        // Revalidate the homepage
        (0, _cache.revalidatePath)('/');
        return {
            success: true
        };
    } catch (error) {
        console.error('Error updating initiative:', error);
        return {
            success: false,
            error: error instanceof Error ? error.message : 'Une erreur est survenue'
        };
    }
}
async function deleteInitiative(id) {
    try {
        if (!id) {
            return {
                success: false,
                error: "L'ID de l'initiative est requis"
            };
        }
        // Get authenticated user
        const supabase = await (0, _server.createClient)();
        const { data: { user }, error: authError } = await supabase.auth.getUser();
        if (authError || !user) {
            return {
                success: false,
                error: 'Vous devez être connecté pour supprimer une initiative'
            };
        }
        // Check if initiative exists and user owns it
        const { data: existing, error: fetchError } = await supabase.from('initiatives').select('user_id').eq('id', id).single();
        if (fetchError || !existing) {
            return {
                success: false,
                error: 'Initiative non trouvée'
            };
        }
        if (existing.user_id !== user.id) {
            return {
                success: false,
                error: "Vous n'êtes pas autorisé à supprimer cette initiative"
            };
        }
        // Delete initiative
        const { error: deleteError } = await supabase.from('initiatives').delete().eq('id', id);
        if (deleteError) {
            console.error('Supabase delete error:', deleteError);
            return {
                success: false,
                error: `Erreur lors de la suppression: ${deleteError.message}`
            };
        }
        // Revalidate the homepage
        (0, _cache.revalidatePath)('/');
        return {
            success: true
        };
    } catch (error) {
        console.error('Error deleting initiative:', error);
        return {
            success: false,
            error: error instanceof Error ? error.message : 'Une erreur est survenue'
        };
    }
}
async function verifyInitiative(id, verified) {
    try {
        if (!id) {
            return {
                success: false,
                error: "L'ID de l'initiative est requis"
            };
        }
        // Get authenticated user
        const supabase = await (0, _server.createClient)();
        const { data: { user }, error: authError } = await supabase.auth.getUser();
        if (authError || !user) {
            return {
                success: false,
                error: 'Vous devez être connecté'
            };
        }
        // TODO: Add admin role check here
        // For now, any authenticated user can verify
        // In production, check user role from profiles table
        // Update verification status
        const { error: updateError } = await supabase.from('initiatives').update({
            verified
        }).eq('id', id);
        if (updateError) {
            console.error('Supabase update error:', updateError);
            return {
                success: false,
                error: `Erreur lors de la vérification: ${updateError.message}`
            };
        }
        // Revalidate the homepage
        (0, _cache.revalidatePath)('/');
        return {
            success: true
        };
    } catch (error) {
        console.error('Error verifying initiative:', error);
        return {
            success: false,
            error: error instanceof Error ? error.message : 'Une erreur est survenue'
        };
    }
}
async function getInitiativeById(id) {
    try {
        if (!id) {
            return {
                success: false,
                error: "L'ID de l'initiative est requis"
            };
        }
        const supabase = await (0, _server.createClient)();
        const { data, error } = await supabase.from('initiatives').select('*').eq('id', id).single();
        if (error || !data) {
            return {
                success: false,
                error: 'Initiative non trouvée'
            };
        }
        return {
            success: true,
            data: {
                id: data.id,
                name: data.name,
                type: data.type,
                description: data.description,
                address: data.address,
                website: data.website,
                phone: data.phone,
                email: data.email,
                verified: data.verified,
                created_at: data.created_at
            }
        };
    } catch (error) {
        console.error('Error fetching initiative:', error);
        return {
            success: false,
            error: error instanceof Error ? error.message : 'Une erreur est survenue'
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9SYXBoYWVsL0RvY3VtZW50cy9ERVYubm9zeW5jL2xhbWFwL3NyYy9hcHAvYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVjayAtIFN1cGFiYXNlIHR5cGVzIG5lZWQgdG8gYmUgZ2VuZXJhdGVkLiBSdW46IG5weCBzdXBhYmFzZSBnZW4gdHlwZXMgdHlwZXNjcmlwdFxuJ3VzZSBzZXJ2ZXInO1xuXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xuXG5pbXBvcnQgdHlwZSB7IEluaXRpYXRpdmVUeXBlIH0gZnJvbSAnQC90eXBlcy9pbml0aWF0aXZlJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbnRlcmZhY2UgQ3JlYXRlSW5pdGlhdGl2ZURhdGEge1xuICBuYW1lOiBzdHJpbmc7XG4gIHR5cGU6IEluaXRpYXRpdmVUeXBlO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgYWRkcmVzcz86IHN0cmluZztcbiAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gIHdlYnNpdGU/OiBzdHJpbmc7XG4gIHBob25lPzogc3RyaW5nO1xuICBlbWFpbD86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFVwZGF0ZUluaXRpYXRpdmVEYXRhIHtcbiAgbmFtZT86IHN0cmluZztcbiAgdHlwZT86IEluaXRpYXRpdmVUeXBlO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgYWRkcmVzcz86IHN0cmluZztcbiAgbGF0aXR1ZGU/OiBudW1iZXI7XG4gIGxvbmdpdHVkZT86IG51bWJlcjtcbiAgd2Vic2l0ZT86IHN0cmluZztcbiAgcGhvbmU/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICB2ZXJpZmllZD86IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBBY3Rpb25SZXNwb25zZTxUID0gdm9pZD4ge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBkYXRhPzogVDtcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDUkVBVEUgSU5JVElBVElWRVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluaXRpYXRpdmUoXG4gIGRhdGE6IENyZWF0ZUluaXRpYXRpdmVEYXRhXG4pOiBQcm9taXNlPEFjdGlvblJlc3BvbnNlPHsgaWQ6IHN0cmluZyB9Pj4ge1xuICB0cnkge1xuICAgIC8vIFZhbGlkYXRpb25cbiAgICBpZiAoIWRhdGEubmFtZSB8fCBkYXRhLm5hbWUudHJpbSgpLmxlbmd0aCA8IDMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0xlIG5vbSBkb2l0IGNvbnRlbmlyIGF1IG1vaW5zIDMgY2FyYWN0w6hyZXMnLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEudHlwZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnTGUgdHlwZSBlc3Qgb2JsaWdhdG9pcmUnLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoaXNOYU4oZGF0YS5sYXRpdHVkZSkgfHwgaXNOYU4oZGF0YS5sb25naXR1ZGUpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdMZXMgY29vcmRvbm7DqWVzIEdQUyBzb250IGludmFsaWRlcycsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIGRhdGEubGF0aXR1ZGUgPCAtOTAgfHxcbiAgICAgIGRhdGEubGF0aXR1ZGUgPiA5MCB8fFxuICAgICAgZGF0YS5sb25naXR1ZGUgPCAtMTgwIHx8XG4gICAgICBkYXRhLmxvbmdpdHVkZSA+IDE4MFxuICAgICkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnTGVzIGNvb3Jkb25uw6llcyBHUFMgc29udCBob3JzIGxpbWl0ZXMnLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICAgIGVycm9yOiBhdXRoRXJyb3IsXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnVm91cyBkZXZleiDDqnRyZSBjb25uZWN0w6kgcG91ciBham91dGVyIHVuZSBpbml0aWF0aXZlJyxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGluaXRpYXRpdmUgd2l0aCBQb3N0R0lTIFBPSU5UXG4gICAgY29uc3QgeyBkYXRhOiBpbml0aWF0aXZlLCBlcnJvcjogaW5zZXJ0RXJyb3IgfSA9IChhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2luaXRpYXRpdmVzJylcbiAgICAgIC5pbnNlcnQoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUudHJpbSgpLFxuICAgICAgICB0eXBlOiBkYXRhLnR5cGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uPy50cmltKCkgfHwgbnVsbCxcbiAgICAgICAgYWRkcmVzczogZGF0YS5hZGRyZXNzPy50cmltKCkgfHwgbnVsbCxcbiAgICAgICAgbG9jYXRpb246IGBQT0lOVCgke2RhdGEubG9uZ2l0dWRlfSAke2RhdGEubGF0aXR1ZGV9KWAsXG4gICAgICAgIHdlYnNpdGU6IGRhdGEud2Vic2l0ZT8udHJpbSgpIHx8IG51bGwsXG4gICAgICAgIHBob25lOiBkYXRhLnBob25lPy50cmltKCkgfHwgbnVsbCxcbiAgICAgICAgZW1haWw6IGRhdGEuZW1haWw/LnRyaW0oKSB8fCBudWxsLFxuICAgICAgICB1c2VyX2lkOiB1c2VyLmlkLFxuICAgICAgICB2ZXJpZmllZDogZmFsc2UsXG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgLnNpbmdsZSgpKSBhcyBhbnk7XG5cbiAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGluc2VydCBlcnJvcjonLCBpbnNlcnRFcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBFcnJldXIgbG9ycyBkZSBsJ2Fqb3V0OiAke2luc2VydEVycm9yLm1lc3NhZ2V9YCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUmV2YWxpZGF0ZSB0aGUgaG9tZXBhZ2UgdG8gc2hvdyB0aGUgbmV3IGluaXRpYXRpdmVcbiAgICByZXZhbGlkYXRlUGF0aCgnLycpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7IGlkOiBpbml0aWF0aXZlLmlkIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBpbml0aWF0aXZlOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5lIGVycmV1ciBlc3Qgc3VydmVudWUnLFxuICAgIH07XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFVQREFURSBJTklUSUFUSVZFXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5pdGlhdGl2ZShcbiAgaWQ6IHN0cmluZyxcbiAgZGF0YTogVXBkYXRlSW5pdGlhdGl2ZURhdGFcbik6IFByb21pc2U8QWN0aW9uUmVzcG9uc2U+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIWlkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IFwiTCdJRCBkZSBsJ2luaXRpYXRpdmUgZXN0IHJlcXVpc1wiLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICAgIGVycm9yOiBhdXRoRXJyb3IsXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnVm91cyBkZXZleiDDqnRyZSBjb25uZWN0w6kgcG91ciBtb2RpZmllciB1bmUgaW5pdGlhdGl2ZScsXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIGluaXRpYXRpdmUgZXhpc3RzIGFuZCB1c2VyIG93bnMgaXRcbiAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gKGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnaW5pdGlhdGl2ZXMnKVxuICAgICAgLnNlbGVjdCgndXNlcl9pZCcpXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2luZ2xlKCkpIGFzIGFueTtcblxuICAgIGlmIChmZXRjaEVycm9yIHx8ICFleGlzdGluZykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnSW5pdGlhdGl2ZSBub24gdHJvdXbDqWUnLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoZXhpc3RpbmcudXNlcl9pZCAhPT0gdXNlci5pZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBcIlZvdXMgbifDqnRlcyBwYXMgYXV0b3Jpc8OpIMOgIG1vZGlmaWVyIGNldHRlIGluaXRpYXRpdmVcIixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUHJlcGFyZSB1cGRhdGUgZGF0YVxuICAgIGNvbnN0IHVwZGF0ZURhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG5cbiAgICBpZiAoZGF0YS5uYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChkYXRhLm5hbWUudHJpbSgpLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogJ0xlIG5vbSBkb2l0IGNvbnRlbmlyIGF1IG1vaW5zIDMgY2FyYWN0w6hyZXMnLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdXBkYXRlRGF0YS5uYW1lID0gZGF0YS5uYW1lLnRyaW0oKTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YS50eXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVwZGF0ZURhdGEudHlwZSA9IGRhdGEudHlwZTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gZGF0YS5kZXNjcmlwdGlvbj8udHJpbSgpIHx8IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGRhdGEuYWRkcmVzcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVEYXRhLmFkZHJlc3MgPSBkYXRhLmFkZHJlc3M/LnRyaW0oKSB8fCBudWxsO1xuICAgIH1cblxuICAgIGlmIChkYXRhLndlYnNpdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlRGF0YS53ZWJzaXRlID0gZGF0YS53ZWJzaXRlPy50cmltKCkgfHwgbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoZGF0YS5waG9uZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVEYXRhLnBob25lID0gZGF0YS5waG9uZT8udHJpbSgpIHx8IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGRhdGEuZW1haWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlRGF0YS5lbWFpbCA9IGRhdGEuZW1haWw/LnRyaW0oKSB8fCBudWxsO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBsb2NhdGlvbiBpZiBib3RoIGNvb3JkaW5hdGVzIGFyZSBwcm92aWRlZFxuICAgIGlmIChkYXRhLmxhdGl0dWRlICE9PSB1bmRlZmluZWQgJiYgZGF0YS5sb25naXR1ZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKGlzTmFOKGRhdGEubGF0aXR1ZGUpIHx8IGlzTmFOKGRhdGEubG9uZ2l0dWRlKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnTGVzIGNvb3Jkb25uw6llcyBHUFMgc29udCBpbnZhbGlkZXMnLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGRhdGEubGF0aXR1ZGUgPCAtOTAgfHxcbiAgICAgICAgZGF0YS5sYXRpdHVkZSA+IDkwIHx8XG4gICAgICAgIGRhdGEubG9uZ2l0dWRlIDwgLTE4MCB8fFxuICAgICAgICBkYXRhLmxvbmdpdHVkZSA+IDE4MFxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdMZXMgY29vcmRvbm7DqWVzIEdQUyBzb250IGhvcnMgbGltaXRlcycsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZURhdGEubG9jYXRpb24gPSBgUE9JTlQoJHtkYXRhLmxvbmdpdHVkZX0gJHtkYXRhLmxhdGl0dWRlfSlgO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBpbml0aWF0aXZlXG4gICAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IChhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2luaXRpYXRpdmVzJylcbiAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcbiAgICAgIC5lcSgnaWQnLCBpZCkpIGFzIGFueTtcblxuICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgdXBkYXRlIGVycm9yOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogYEVycmV1ciBsb3JzIGRlIGxhIG1vZGlmaWNhdGlvbjogJHt1cGRhdGVFcnJvci5tZXNzYWdlfWAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIFJldmFsaWRhdGUgdGhlIGhvbWVwYWdlXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy8nKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgaW5pdGlhdGl2ZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1VuZSBlcnJldXIgZXN0IHN1cnZlbnVlJyxcbiAgICB9O1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBERUxFVEUgSU5JVElBVElWRVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluaXRpYXRpdmUoaWQ6IHN0cmluZyk6IFByb21pc2U8QWN0aW9uUmVzcG9uc2U+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIWlkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IFwiTCdJRCBkZSBsJ2luaXRpYXRpdmUgZXN0IHJlcXVpc1wiLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICAgIGVycm9yOiBhdXRoRXJyb3IsXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnVm91cyBkZXZleiDDqnRyZSBjb25uZWN0w6kgcG91ciBzdXBwcmltZXIgdW5lIGluaXRpYXRpdmUnLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBpbml0aWF0aXZlIGV4aXN0cyBhbmQgdXNlciBvd25zIGl0XG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZywgZXJyb3I6IGZldGNoRXJyb3IgfSA9IChhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2luaXRpYXRpdmVzJylcbiAgICAgIC5zZWxlY3QoJ3VzZXJfaWQnKVxuICAgICAgLmVxKCdpZCcsIGlkKVxuICAgICAgLnNpbmdsZSgpKSBhcyBhbnk7XG5cbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhZXhpc3RpbmcpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0luaXRpYXRpdmUgbm9uIHRyb3V2w6llJyxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKGV4aXN0aW5nLnVzZXJfaWQgIT09IHVzZXIuaWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogXCJWb3VzIG4nw6p0ZXMgcGFzIGF1dG9yaXPDqSDDoCBzdXBwcmltZXIgY2V0dGUgaW5pdGlhdGl2ZVwiLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBEZWxldGUgaW5pdGlhdGl2ZVxuICAgIGNvbnN0IHsgZXJyb3I6IGRlbGV0ZUVycm9yIH0gPSAoYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdpbml0aWF0aXZlcycpXG4gICAgICAuZGVsZXRlKClcbiAgICAgIC5lcSgnaWQnLCBpZCkpIGFzIGFueTtcblxuICAgIGlmIChkZWxldGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgZGVsZXRlIGVycm9yOicsIGRlbGV0ZUVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogYEVycmV1ciBsb3JzIGRlIGxhIHN1cHByZXNzaW9uOiAke2RlbGV0ZUVycm9yLm1lc3NhZ2V9YCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUmV2YWxpZGF0ZSB0aGUgaG9tZXBhZ2VcbiAgICByZXZhbGlkYXRlUGF0aCgnLycpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbml0aWF0aXZlOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5lIGVycmV1ciBlc3Qgc3VydmVudWUnLFxuICAgIH07XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFZFUklGWSBJTklUSUFUSVZFIChBZG1pbiBvbmx5KVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUluaXRpYXRpdmUoXG4gIGlkOiBzdHJpbmcsXG4gIHZlcmlmaWVkOiBib29sZWFuXG4pOiBQcm9taXNlPEFjdGlvblJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFpZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBcIkwnSUQgZGUgbCdpbml0aWF0aXZlIGVzdCByZXF1aXNcIixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyB1c2VyIH0sXG4gICAgICBlcnJvcjogYXV0aEVycm9yLFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcblxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1ZvdXMgZGV2ZXogw6p0cmUgY29ubmVjdMOpJyxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gVE9ETzogQWRkIGFkbWluIHJvbGUgY2hlY2sgaGVyZVxuICAgIC8vIEZvciBub3csIGFueSBhdXRoZW50aWNhdGVkIHVzZXIgY2FuIHZlcmlmeVxuICAgIC8vIEluIHByb2R1Y3Rpb24sIGNoZWNrIHVzZXIgcm9sZSBmcm9tIHByb2ZpbGVzIHRhYmxlXG5cbiAgICAvLyBVcGRhdGUgdmVyaWZpY2F0aW9uIHN0YXR1c1xuICAgIGNvbnN0IHsgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSAoYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdpbml0aWF0aXZlcycpXG4gICAgICAudXBkYXRlKHsgdmVyaWZpZWQgfSlcbiAgICAgIC5lcSgnaWQnLCBpZCkpIGFzIGFueTtcblxuICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgdXBkYXRlIGVycm9yOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogYEVycmV1ciBsb3JzIGRlIGxhIHbDqXJpZmljYXRpb246ICR7dXBkYXRlRXJyb3IubWVzc2FnZX1gLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBSZXZhbGlkYXRlIHRoZSBob21lcGFnZVxuICAgIHJldmFsaWRhdGVQYXRoKCcvJyk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZlcmlmeWluZyBpbml0aWF0aXZlOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5lIGVycmV1ciBlc3Qgc3VydmVudWUnLFxuICAgIH07XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEdFVCBJTklUSUFUSVZFIEJZIElEXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5pdGlhdGl2ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8XG4gIEFjdGlvblJlc3BvbnNlPHtcbiAgICBpZDogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0eXBlOiBJbml0aWF0aXZlVHlwZTtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nIHwgbnVsbDtcbiAgICBhZGRyZXNzOiBzdHJpbmcgfCBudWxsO1xuICAgIHdlYnNpdGU6IHN0cmluZyB8IG51bGw7XG4gICAgcGhvbmU6IHN0cmluZyB8IG51bGw7XG4gICAgZW1haWw6IHN0cmluZyB8IG51bGw7XG4gICAgdmVyaWZpZWQ6IGJvb2xlYW47XG4gICAgY3JlYXRlZF9hdDogc3RyaW5nO1xuICB9PlxuPiB7XG4gIHRyeSB7XG4gICAgaWYgKCFpZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBcIkwnSUQgZGUgbCdpbml0aWF0aXZlIGVzdCByZXF1aXNcIixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSAoYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdpbml0aWF0aXZlcycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKSkgYXMgYW55O1xuXG4gICAgaWYgKGVycm9yIHx8ICFkYXRhKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdJbml0aWF0aXZlIG5vbiB0cm91dsOpZScsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICBpZDogZGF0YS5pZCxcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICB0eXBlOiBkYXRhLnR5cGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICBhZGRyZXNzOiBkYXRhLmFkZHJlc3MsXG4gICAgICAgIHdlYnNpdGU6IGRhdGEud2Vic2l0ZSxcbiAgICAgICAgcGhvbmU6IGRhdGEucGhvbmUsXG4gICAgICAgIGVtYWlsOiBkYXRhLmVtYWlsLFxuICAgICAgICB2ZXJpZmllZDogZGF0YS52ZXJpZmllZCxcbiAgICAgICAgY3JlYXRlZF9hdDogZGF0YS5jcmVhdGVkX2F0LFxuICAgICAgfSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluaXRpYXRpdmU6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmUgZXJyZXVyIGVzdCBzdXJ2ZW51ZScsXG4gICAgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUluaXRpYXRpdmUiLCJkZWxldGVJbml0aWF0aXZlIiwiZ2V0SW5pdGlhdGl2ZUJ5SWQiLCJ1cGRhdGVJbml0aWF0aXZlIiwidmVyaWZ5SW5pdGlhdGl2ZSIsImRhdGEiLCJuYW1lIiwidHJpbSIsImxlbmd0aCIsInN1Y2Nlc3MiLCJlcnJvciIsInR5cGUiLCJpc05hTiIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwic3VwYWJhc2UiLCJjcmVhdGVDbGllbnQiLCJ1c2VyIiwiYXV0aEVycm9yIiwiYXV0aCIsImdldFVzZXIiLCJpbml0aWF0aXZlIiwiaW5zZXJ0RXJyb3IiLCJmcm9tIiwiaW5zZXJ0IiwiZGVzY3JpcHRpb24iLCJhZGRyZXNzIiwibG9jYXRpb24iLCJ3ZWJzaXRlIiwicGhvbmUiLCJlbWFpbCIsInVzZXJfaWQiLCJpZCIsInZlcmlmaWVkIiwic2VsZWN0Iiwic2luZ2xlIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJyZXZhbGlkYXRlUGF0aCIsIkVycm9yIiwiZXhpc3RpbmciLCJmZXRjaEVycm9yIiwiZXEiLCJ1cGRhdGVEYXRhIiwidW5kZWZpbmVkIiwidXBkYXRl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